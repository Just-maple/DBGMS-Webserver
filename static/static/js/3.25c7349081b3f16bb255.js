webpackJsonp([3],{"9ive":function(t,n,a){(t.exports=a("FZ+f")(!0)).push([t.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","",{version:3,sources:[],names:[],mappings:"",file:"dataAjaxForm.vue",sourceRoot:""}])},"KWM/":function(t,n,a){var e=a("xwNb");"string"==typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);a("rjj0")("70d10aee",e,!0)},"W1B/":function(t,n,a){(t.exports=a("FZ+f")(!0)).push([t.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","",{version:3,sources:[],names:[],mappings:"",file:"dynamicTable.vue",sourceRoot:""}])},pcaf:function(t,n,a){var e=a("W1B/");"string"==typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);a("rjj0")("0240bc8f",e,!0)},vATp:function(t,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=a("iYqH"),i=(a("/I4U"),a("+BTi"),a("yg6k")),s=a.n(i),o=a("DxEk"),r=a("gHng"),d=a("AM46"),c=a("ixD9"),l=a("ad1Z"),h=a("itTt"),f=a("eD+R"),p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g={components:{pagination:o.a,tableBody:r.a,tableHead:l.a,selector:h.a,exportTable:f.a,hidden:d.a,loadingBody:c.a},props:["config","self"],data:function(){return{data:this.config,pagination:{pageCount:10,selectPage:0},selector:{sortKey:{reverse:!1,key:""},matcher:this.config.matcher||{}},dataDistinct:{},dataDownLoad:!1,apiTable:""}},created:function(){this.selector.matcher=this.data.matcher||{},this.$set(this.data,"data",[]);var t=this.data.api.split("/");this.apiTable=t[t.length-1],this.$store.state.form[this.apiTable]&&this.$set(this.data,"table",this.$store.state.form[this.apiTable]),this.pagination.pageCount=this.data.table._pcount||10,this.data.table._sort&&(this.selector.sortKey={key:this.data.table._sort,reverse:this.data.table._rsort}),this.getAjaxData(this.data,this.initDataDistinct)},methods:{getAllExportData:function(t,n){var a=this,e=this.data,i=e.startTime;i=i?"&st="+Date.parse(i)/1e3:"";var o=e.endTime;o=o?"&et="+Date.parse(o)/1e3:"",this.dataDownLoad?alert("数据下载中,请稍后再试"):(this.dataDownLoad=!0,this.$http.post(e.api+"?skip=0&limit=0"+i+o+"&sort="+(this.selector.sortKey.key||"")+"&reverse="+(this.selector.sortKey.reverse?"":"-"),{matcher:this.selector.matcher,keys:n}).then(function(n){a.dataDownLoad=!1,t(n.data.data.data)}).catch(function(t){a.dataDownLoad=!1,console.log(t),alert("导出失败,请检查重试")}),s.a.info({message:"数据下载中,请耐心等待下载完成",duration:2e3}))},selectKey:function(t){0===t[0].length||t[0].indexOf("all")>-1?delete this.selector.matcher[t[1]]:this.$set(this.selector.matcher,t[1],{$in:t[0]}),this.getAjaxData(this.data)},initDataDistinct:function(){var t=this,n=function(n){"group"===t.data.table[n].type&&t.$http.get(t.data.api.replace("_ajax","_dst")+"?key="+n).then(function(a){t.$set(t.dataDistinct,n,(a.data.data||[]).sort(function(t,n){switch(void 0===t?"undefined":p(t)){case"number":return t-n;default:return[t,n].sort().indexOf(t)-[t,n].sort().indexOf(n)}}))}).catch(function(a){t.$set(t.dataDistinct,n,[])})};for(var a in this.data.table)n(a)},getDataDistinct:function(t,n){return this.dataDistinct.hasOwnProperty(n)?this.dataDistinct[n].map(function(t){return function(t,n,a){return n in t?Object.defineProperty(t,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[n]=a,t}({},n,t)}):[]},setSortKey:function(t){var n=this.selector.sortKey;n.reverse=n.key===t?!n.reverse:n.reverse,n.key=t,this.data.table._sort=t,this.data.table._rsort=n.reverse,this.getAjaxData(this.data)},groupSelect:function(t){return t},getTableWidth:function(){var t=this.data;return(t.methods?Object.keys(t.methods).length:1)+Object.keys(t.table).length+1},changePage:function(t){this.pagination.selectPage=t-1,this.getAjaxData(this.data)},changeSize:function(t){this.pagination.pageCount=t,this.$set(this.data.table,"_pcount",t),this.getAjaxData(this.data)},getAjaxData:function(t,n){var a=this;t.data=void 0;var e=t.startTime;e=e?"&st="+Date.parse(e)/1e3:"";var i=t.endTime;i=i?"&et="+Date.parse(i)/1e3:"",this.$http.post(t.api+"?skip="+this.pagination.selectPage*this.pagination.pageCount+"&limit="+this.pagination.pageCount+e+i+"&sort="+(this.selector.sortKey.key||"")+"&reverse="+(this.selector.sortKey.reverse?"":"-"),this.selector).then(function(e){n&&n(),t.data=e.data.data.data,a.$set(t,"seltotal",e.data.data.cnt)}).catch(function(n){console.log(n),t.data=[],a.$set(t,"seltotal",0),s.a.error({title:"错误",message:"加载数据失败,请检查网络重试",duration:1e3})})}}},u={render:function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticClass:"xdTable"},[this.data.table?n("table",{staticStyle:{"text-align":"center",width:"100%"},attrs:{border:"1"}},[n("tr",[n("td",{attrs:{colspan:this.getTableWidth()}},[n("selector",{attrs:{getSelectItem:this.getDataDistinct,data:this.data},on:{selectKey:this.selectKey}}),this._v(" "),n("div",{staticStyle:{float:"right",margin:"10px 10px"}},[n("hidden",{staticStyle:{margin:"0 5px"},attrs:{data:this.config}}),this._v(" "),n("export-table",{attrs:{data:this.data,dataDownLoad:this.dataDownLoad,exporter:this.getAllExportData}})],1)],1)]),this._v(" "),n("table-head",{attrs:{sort:this.selector.sortKey,data:this.data},on:{sortData:this.setSortKey}}),this._v(" "),n("table-body",{attrs:{self:this.self,data:this.data,groupSelect:this.groupSelect}}),this._v(" "),n("loading-body",{attrs:{data:this.data.data,width:this.getTableWidth()}}),this._v(" "),n("tr",[n("td",{attrs:{colspan:this.getTableWidth()}},[n("pagination",{attrs:{data:this.data,total:this.data.seltotal,pageCount:this.data.table._pcount||10},on:{selectPage:this.changePage,changeSize:this.changeSize}})],1)])],1):this._e()])},staticRenderFns:[]},m=a("VU/8")(g,u,!1,function(t){a("w7dL")},null,null).exports,b={components:{dataForm:e.a,dataAjaxForm:m},data:function(){return{updator:0,data:{},clear:!0}},created:function(){this.data=this.config},destroyed:function(){this.$store.state.dataPageUpdater+=1},methods:{changeDate:function(){this.data.data=void 0,this.$emit("updateDate"),this.$store.state.dataPageUpdater+=1}},props:["config","self","autoUpdate"]},v={render:function(){var t=this,n=t.$createElement,a=t._self._c||n;return a("div",[a("div",{staticStyle:{float:"right",margin:"10px"}},[t._v("结束日期\n    "),a("el-date-picker",{attrs:{clearable:!1,type:"date",placeholder:"结束日期"},on:{change:t.changeDate},model:{value:t.data.endTime,callback:function(n){t.$set(t.data,"endTime",n)},expression:"data.endTime"}})],1),t._v(" "),a("div",{staticStyle:{float:"right",margin:"10px"}},[t._v("开始日期\n    "),a("el-date-picker",{attrs:{type:"date",clearable:!1,placeholder:"开始日期"},on:{change:t.changeDate},model:{value:t.data.startTime,callback:function(n){t.$set(t.data,"startTime",n)},expression:"data.startTime"}})],1),t._v(" "),a("div",{staticStyle:{clear:"both"}}),t._v(" "),t.clear&&!t.data.ajax?a("data-form",{key:t.$store.state.dataPageUpdater,attrs:{self:t.self,config:t.data,autoUpdate:t.autoUpdate}}):t._e(),t._v(" "),t.data.ajax?a("data-ajax-form",{key:t.$store.state.dataPageUpdater,attrs:{config:t.data,self:t.self}}):t._e()],1)},staticRenderFns:[]},y=a("VU/8")(b,v,!1,function(t){a("KWM/")},null,null).exports,x={data:function(){return{formConfig:{},tableConfig:{api:"",table:{},startTime:0,endTime:0},inited:!1}},created:function(){this.initConfig()},components:{dataForm:e.a,dataPage:y},methods:{initConfig:function(){this.formConfig=this.$route.meta.config,this.tableConfig.api=this.formConfig._api,this.tableConfig.table=this.formConfig,this.tableConfig.startTime=this.getTodayTime(this.formConfig._startTime||0),this.tableConfig.endTime=this.getTodayTime(this.formConfig._endTime||1),this.inited=!0}}},D={render:function(){var t=this.$createElement,n=this._self._c||t;return n("div",[this.inited?n("div",[this.formConfig._pageForm?n("data-page",{attrs:{config:this.tableConfig}}):n("data-form",{attrs:{config:this.tableConfig}})],1):this._e()])},staticRenderFns:[]},_=a("VU/8")(x,D,!1,function(t){a("pcaf")},null,null);n.default=_.exports},w7dL:function(t,n,a){var e=a("9ive");"string"==typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);a("rjj0")("ff73f24a",e,!0)},xwNb:function(t,n,a){(t.exports=a("FZ+f")(!0)).push([t.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","",{version:3,sources:[],names:[],mappings:"",file:"dataPage.vue",sourceRoot:""}])}});